<ion-modal [isOpen]="isOpen" (didDismiss)="onModalDidDismiss()">
  <ng-template>
    <ion-header>
      <ion-toolbar>
        <ion-title>
          <ion-icon name="images-outline" slot="start"></ion-icon>
          Media Gallery
        </ion-title>
        <ion-buttons slot="end">
          <ion-button (click)="onClose()">
            <ion-icon name="close" slot="icon-only"></ion-icon>
          </ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>

    <ion-content class="ion-padding">
      <!-- Loading State -->
      <div *ngIf="isLoading" class="loading-container">
        <ion-spinner name="crescent"></ion-spinner>
        <p>Loading media...</p>
      </div>

      <!-- Empty State -->
      <div *ngIf="!isLoading && mediaItems.length === 0" class="empty-state">
        <ion-icon name="images-outline" class="empty-icon"></ion-icon>
        <h2>No media found</h2>
        <p>This story doesn't contain any images or videos yet.</p>
      </div>

      <!-- Media Grid -->
      <ion-grid *ngIf="!isLoading && mediaItems.length > 0">
        <ion-row>
          <ion-col
            size="6"
            size-md="4"
            size-lg="3"
            *ngFor="let item of mediaItems"
            class="media-col">
            <ion-card
              class="media-card"
              (click)="onMediaItemClick(item)"
              button="true">
              <div class="media-wrapper">
                <img
                  [src]="item.imageSrc"
                  [alt]="item.imageAlt || 'Story media'"
                  class="media-image" />
                <div *ngIf="item.hasVideo" class="video-indicator">
                  <ion-icon name="videocam-outline"></ion-icon>
                </div>
              </div>
            </ion-card>
          </ion-col>
        </ion-row>
      </ion-grid>
    </ion-content>
  </ng-template>
</ion-modal>

<!-- Image Viewer Modal -->
<app-image-viewer-modal
  [isOpen]="showImageViewer"
  [imageSrc]="selectedMediaItem?.imageSrc || null"
  [imageAlt]="selectedMediaItem?.imageAlt || ''"
  [imageTitle]="selectedMediaItem?.imageAlt || ''"
  [videoSrc]="selectedVideoSrc"
  [videoName]="selectedVideoName"
  [loadingVideo]="loadingVideo"
  (closed)="onImageViewerClosed()">
</app-image-viewer-modal>
